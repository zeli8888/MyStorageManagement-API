package ze.mystoragemanagement.model;

import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonView;
import jakarta.persistence.*;

import java.util.HashSet;
import java.util.Set;

/**
 * @Author : Ze Li
 * @Date : 12/02/2025 12:40
 * @Version : V1.0
 * @Description :
 */
@JsonIgnoreProperties({"hibernateLazyInitializer", "handler"})
@Entity
public class Dish {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @JsonView(Views.DishRecordView.class)
    private Long dishId;

    @Column(unique = true, nullable = false)
    @JsonView(Views.DishRecordView.class)
    private String dishName;

    private String dishDesc;

    @OneToMany(mappedBy = "dish", fetch = FetchType.LAZY, cascade = CascadeType.ALL, orphanRemoval = true)
    private Set<DishIngredient> dishIngredients = new HashSet<>();

    @OneToMany(mappedBy = "dish", fetch = FetchType.LAZY, cascade = CascadeType.ALL, orphanRemoval = false)
    @JsonIgnore
    private Set<DishRecord> dishRecords = new HashSet<>();

    public String getDishName() {
        return dishName;
    }

    public void setDishName(String dishName) {
        this.dishName = dishName;
    }

    public Dish(Long dishId, String dishName, String dishDesc, Set<DishIngredient> dishIngredients) {
        this.dishId = dishId;
        this.dishName = dishName;
        this.dishDesc = dishDesc;
        this.dishIngredients = dishIngredients;
    }

    public Dish(Long dishId, String dishName, String dishDesc, Set<DishIngredient> dishIngredients, Set<DishRecord> dishRecords) {
        this.dishId = dishId;
        this.dishName = dishName;
        this.dishDesc = dishDesc;
        this.dishIngredients = dishIngredients;
        this.dishRecords = dishRecords;
    }

    public Dish() {
    }

    public Set<DishRecord> getDishRecords() {
        return dishRecords;
    }

    public void setDishRecords(Set<DishRecord> dishRecords) {
        this.dishRecords = dishRecords;
    }

    public Long getDishId() {
        return dishId;
    }

    public void setDishId(Long dishId) {
        this.dishId = dishId;
    }

    public String getDishDesc() {
        return dishDesc;
    }

    public void setDishDesc(String dishDesc) {
        this.dishDesc = dishDesc;
    }

    public Set<DishIngredient> getDishIngredients() {
        return dishIngredients;
    }

    public void setDishIngredients(Set<DishIngredient> ingredients) {
        this.dishIngredients = ingredients;
    }
}
